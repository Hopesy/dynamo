<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.49">
    <meta name="referrer" content="no-referrer" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta name="referrer" content="no-referrer"><link rel="icon" href="/images/favicon.png"><title>Python For Dynamo 基础 | Dynamo Learn</title><meta name="description" content="welocome to Dynamo wiki by hopesy">
    <link rel="modulepreload" href="/assets/app.4258e646.js"><link rel="modulepreload" href="/assets/pythonScript.html.9dc3d540.js"><link rel="modulepreload" href="/assets/pythonScript.html.e64b74b6.js"><link rel="prefetch" href="/assets/index.html.c0a2200c.js"><link rel="prefetch" href="/assets/pythonLearn.html.13bd0a30.js"><link rel="prefetch" href="/assets/revitAPI.html.4df208dd.js"><link rel="prefetch" href="/assets/setup.html.7c08892a.js"><link rel="prefetch" href="/assets/template.html.bfed4e25.js"><link rel="prefetch" href="/assets/备份.html.6eb130ae.js"><link rel="prefetch" href="/assets/about.html.89550f86.js"><link rel="prefetch" href="/assets/copy.html.2bd2d471.js"><link rel="prefetch" href="/assets/excel.html.19dda8c5.js"><link rel="prefetch" href="/assets/hide.html.779f5958.js"><link rel="prefetch" href="/assets/loading.html.204176c9.js"><link rel="prefetch" href="/assets/message.html.e092a5f2.js"><link rel="prefetch" href="/assets/mongo.html.af391559.js"><link rel="prefetch" href="/assets/weixin.html.f2b4983d.js"><link rel="prefetch" href="/assets/basic.html.e64cd685.js"><link rel="prefetch" href="/assets/node.html.db28897c.js"><link rel="prefetch" href="/assets/resource.html.0d1ed27e.js"><link rel="prefetch" href="/assets/tipes.html.d765d4b5.js"><link rel="prefetch" href="/assets/404.html.7d858b3d.js"><link rel="prefetch" href="/assets/index.html.8119cda2.js"><link rel="prefetch" href="/assets/pythonLearn.html.2ddf65cc.js"><link rel="prefetch" href="/assets/revitAPI.html.1be3d316.js"><link rel="prefetch" href="/assets/setup.html.a10dd0b9.js"><link rel="prefetch" href="/assets/template.html.4d340369.js"><link rel="prefetch" href="/assets/备份.html.5c3c6351.js"><link rel="prefetch" href="/assets/about.html.dc60d049.js"><link rel="prefetch" href="/assets/copy.html.171eeed9.js"><link rel="prefetch" href="/assets/excel.html.6a82bef8.js"><link rel="prefetch" href="/assets/hide.html.48853c63.js"><link rel="prefetch" href="/assets/loading.html.a2b4f19e.js"><link rel="prefetch" href="/assets/message.html.ab80fe08.js"><link rel="prefetch" href="/assets/mongo.html.6d557594.js"><link rel="prefetch" href="/assets/weixin.html.c05c6cea.js"><link rel="prefetch" href="/assets/basic.html.48401cd1.js"><link rel="prefetch" href="/assets/node.html.7cba7156.js"><link rel="prefetch" href="/assets/resource.html.37b6a42c.js"><link rel="prefetch" href="/assets/tipes.html.7dfbd49d.js"><link rel="prefetch" href="/assets/404.html.aedf9105.js"><link rel="prefetch" href="/assets/404.0a805f2c.js"><link rel="prefetch" href="/assets/Layout.4d445a43.js">
    <link rel="stylesheet" href="/assets/style.f4d22aab.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name can-hide">Dynamo Learn</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="基础"><span class="title">基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="基础"><span class="title">基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/start/basic.md" class="" aria-label="起步"><!--[--><!--]--> 起步 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/start/node.md" class="" aria-label="节点"><!--[--><!--]--> 节点 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/start/tipes.md" class="" aria-label="技巧"><!--[--><!--]--> 技巧 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/start/resource.md" class="" aria-label="资源"><!--[--><!--]--> 资源 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="进阶"><span class="title">进阶</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="进阶"><span class="title">进阶</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/advance/setup.md" class="" aria-label="环境搭建"><!--[--><!--]--> 环境搭建 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/advance/template.md" class="" aria-label="常用模板"><!--[--><!--]--> 常用模板 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/advance/revitApi.md" class="" aria-label="Revit Api"><!--[--><!--]--> Revit Api <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/advance/pythonLearn.md" class="" aria-label="Python 学习"><!--[--><!--]--> Python 学习 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/advance/pythonScript.md" class="" aria-label="Python Script"><!--[--><!--]--> Python Script <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/example/hide.md" class="" aria-label="案例"><!--[--><!--]--> 案例 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="联系"><span class="title">联系</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="联系"><span class="title">联系</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/hopesy" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://hopesy.cc" rel="noopener noreferrer" target="_blank" aria-label="blog"><!--[--><!--]--> blog <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://space.bilibili.com/34975025?spm_id_from=333.1007.0.0" rel="noopener noreferrer" target="_blank" aria-label="B站"><!--[--><!--]--> B站 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/weixin.md" class="" aria-label="联系方式"><!--[--><!--]--> 联系方式 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="基础"><span class="title">基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="基础"><span class="title">基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/start/basic.md" class="" aria-label="起步"><!--[--><!--]--> 起步 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/start/node.md" class="" aria-label="节点"><!--[--><!--]--> 节点 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/start/tipes.md" class="" aria-label="技巧"><!--[--><!--]--> 技巧 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/start/resource.md" class="" aria-label="资源"><!--[--><!--]--> 资源 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="进阶"><span class="title">进阶</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="进阶"><span class="title">进阶</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/advance/setup.md" class="" aria-label="环境搭建"><!--[--><!--]--> 环境搭建 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/advance/template.md" class="" aria-label="常用模板"><!--[--><!--]--> 常用模板 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/advance/revitApi.md" class="" aria-label="Revit Api"><!--[--><!--]--> Revit Api <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/advance/pythonLearn.md" class="" aria-label="Python 学习"><!--[--><!--]--> Python 学习 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/advance/pythonScript.md" class="" aria-label="Python Script"><!--[--><!--]--> Python Script <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/example/hide.md" class="" aria-label="案例"><!--[--><!--]--> 案例 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="联系"><span class="title">联系</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="联系"><span class="title">联系</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/hopesy" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://hopesy.cc" rel="noopener noreferrer" target="_blank" aria-label="blog"><!--[--><!--]--> blog <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://space.bilibili.com/34975025?spm_id_from=333.1007.0.0" rel="noopener noreferrer" target="_blank" aria-label="B站"><!--[--><!--]--> B站 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/weixin.md" class="" aria-label="联系方式"><!--[--><!--]--> 联系方式 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a aria-current="page" href="/advance/pythonScript.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="Python For Dynamo 基础"><!--[--><!--]--> Python For Dynamo 基础 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/advance/pythonScript.html#_1-python-script基础" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.Python Script基础"><!--[--><!--]--> 1.Python Script基础 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/advance/pythonScript.html#_2-dynamo引用python库与-net库-dynamo2-0" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.Dynamo引用Python库与.Net库(dynamo2.0)"><!--[--><!--]--> 2.Dynamo引用Python库与.Net库(dynamo2.0) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/advance/pythonScript.html#_3-常用dll库的相关路径-python-path里面均已添加路径" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.常用dll库的相关路径(PYTHON PATH里面均已添加路径)"><!--[--><!--]--> 3.常用dll库的相关路径(PYTHON PATH里面均已添加路径) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/advance/pythonScript.html#_4-cpython、ipython、pypy、jython、ironpython名词解释" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.CPython、IPython、PyPy、Jython、IronPython名词解释"><!--[--><!--]--> 4.CPython、IPython、PyPy、Jython、IronPython名词解释 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/advance/pythonScript.html#_5-dynamo-节点及revit-api的调用" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.Dynamo 节点及Revit Api的调用"><!--[--><!--]--> 5.Dynamo 节点及Revit Api的调用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/advance/pythonScript.html#_6-常用dll文件说明" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.常用DLL文件说明"><!--[--><!--]--> 6.常用DLL文件说明 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/advance/pythonScript.html#_7-python-script调用dynamo自带的节点库" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.Python Script调用Dynamo自带的节点库"><!--[--><!--]--> 7.Python Script调用Dynamo自带的节点库 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/advance/pythonScript.html#_8-使用revitapi放置族实例" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.使用RevitAPI放置族实例"><!--[--><!--]--> 8.使用RevitAPI放置族实例 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/advance/pythonScript.html#_9-使用revitapi过滤器获取族类型族实例" class="router-link-active router-link-exact-active sidebar-item" aria-label="9.使用RevitApi过滤器获取族类型族实例"><!--[--><!--]--> 9.使用RevitApi过滤器获取族类型族实例 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/advance/pythonScript.html#_10-python-script中使用dynamo节点函数操纵族实例" class="router-link-active router-link-exact-active sidebar-item" aria-label="10.Python Script中使用Dynamo节点函数操纵族实例"><!--[--><!--]--> 10.Python Script中使用Dynamo节点函数操纵族实例 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="python-for-dynamo-基础" tabindex="-1"><a class="header-anchor" href="#python-for-dynamo-基础" aria-hidden="true">#</a> Python For Dynamo 基础</h1><blockquote><p>Revit API网址</p></blockquote><p><a href="https:_apidocs.co_apps_revit_2018_d4648875-d41a-783b-d5f4-638df39ee413">https://apidocs.co/apps/revit/2018/d4648875-d41a-783b-d5f4-638df39ee413.htm</a></p><h3 id="_1-python-script基础" tabindex="-1"><a class="header-anchor" href="#_1-python-script基础" aria-hidden="true">#</a> 1.Python Script基础</h3><h4 id="_1-1调用python" tabindex="-1"><a class="header-anchor" href="#_1-1调用python" aria-hidden="true">#</a> 1.1调用Python</h4><blockquote><p>搜索Python Script节点即可使用，双击进入编辑脚本，保存运行</p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248385469-53235d29-909a-47dd-9c5c-5ddad67320ca.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=fWC2B&amp;originHeight=996&amp;originWidth=1198&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""></p><blockquote><p>可以像Code Block一样直接调用Dynamo中的方法</p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248385606-9afcaabc-8429-476a-9911-6119b824cbe4.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=AbmMX&amp;originHeight=864&amp;originWidth=1247&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""></p><h4 id="_1-2节点默认代码说明" tabindex="-1"><a class="header-anchor" href="#_1-2节点默认代码说明" aria-hidden="true">#</a> 1.2节点默认代码说明</h4><ul><li>import sys-引入Python标准库</li><li>import clr 引入clr(Common Language Runtime)库。它是Python程序运行在.net平台的基础。</li><li>clr.AddReference(&#39;ProtoGeometry&#39;) 引入Dynamo自身的图形处理库</li><li>from Autodesk.DesignScript.Geometry import *  引入库下面的所有类和方法</li><li>dataEnteringNode = IN 用户输入数据，多个可以<code>IN[0].IN[1]</code>获取</li><li>OUT = 0 输出的数据，多个<code>OUT = a,b,c</code></li></ul><h3 id="_2-dynamo引用python库与-net库-dynamo2-0" tabindex="-1"><a class="header-anchor" href="#_2-dynamo引用python库与-net库-dynamo2-0" aria-hidden="true">#</a> 2.Dynamo引用Python库与.Net库(dynamo2.0)</h3><h4 id="_2-1导入ironpython自带的模块-xx-py" tabindex="-1"><a class="header-anchor" href="#_2-1导入ironpython自带的模块-xx-py" aria-hidden="true">#</a> 2.1导入IronPython自带的模块(xx.py)</h4><blockquote><p>对于导入IronPython自身，或者revit写好的.dll模块是不需要指定路径的（IronPython,dynamo已经帮我们做好了）。 Dynamo使用的是IronPython(Python2.x在.net平台上的python版本),模块的导入方式是不太一样的，这种模块必须是支持IronPython，而不是只支持Python。将Dynamo升级到2.7版本之后就可以使用Python3.x了。</p></blockquote><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> math <span class="token comment">#导入自身的数学库模块</span>
<span class="token keyword">import</span> random<span class="token comment">#对于导入IronPython自身，或者revit写好的.dll模块是不需要指定路径的（IronPython,dynamo已经帮我们做好了）。</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-2导入revit准备好的dll文件" tabindex="-1"><a class="header-anchor" href="#_2-2导入revit准备好的dll文件" aria-hidden="true">#</a> 2.2导入Revit准备好的dll文件</h4><blockquote><p>如果不是通过Python编写的模块例如.NET库，需要通过CLR模块来引用。而且将这个文件引用之后，需要从它的命名空间中导入类。</p></blockquote><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> clr <span class="token comment">#导入自身对.net引用的功能模块，有了它才能在Python中解析C#。不管是revit中定义好的模块，还是自定义/第三方模块，都需要先引入这个模块，然后再通过这个模块方法进行导入</span>
<span class="token comment"># 导入Revit自身的模块 RevitAPI.dll 和 RevitAPIUI.dll</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPI&quot;</span><span class="token punctuation">)</span>  <span class="token comment">#导入RevitAPI.dll文件，文件后缀.dll可以省略</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPIUI&quot;</span><span class="token punctuation">)</span><span class="token comment">#导入RevitAPIUI.dll文件，文件后缀.dll可以省略</span>
<span class="token keyword">import</span> Autodesk <span class="token comment">#导入Autodesk命名空间，这个导入命名空间可以省略，最好加上吧</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token comment">#再从具体的命名空间下引入模块</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>UI <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token comment">#再从具体的命名空间下引入模块</span>
<span class="token keyword">import</span> Revit
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">)</span><span class="token comment">#相当于 from NameSpace import *</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3导入自定义模块-自己定义的-dll" tabindex="-1"><a class="header-anchor" href="#_2-3导入自定义模块-自己定义的-dll" aria-hidden="true">#</a> 2.3导入自定义模块（自己定义的.dll）</h4><blockquote><p>对于自定义模块也就是自己写在.dll文件中的类或者函数。需要先导入sys模块然后将模块所在的目录添加到[PYTHONPATH]中</p></blockquote><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> clr <span class="token comment">#导入自身对.net dll引用的功能模块</span>
<span class="token keyword">import</span> sys <span class="token comment">#导入系统功能的模块,下面主要用于指定dll路径</span>
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">r&quot;dll文件所在的地址&quot;</span><span class="token punctuation">)</span><span class="token comment">#指定dll文件所在的地址,前面有r转义字符,直接复制粘贴地址就行</span>
clr<span class="token punctuation">.</span>AddReference <span class="token punctuation">(</span><span class="token string">&quot;xxx.dll&quot;</span><span class="token punctuation">)</span> <span class="token comment"># 需要导入的dll名称</span>
<span class="token keyword">import</span> xxxNamspace  <span class="token comment"># 导入这个dll文件中,我们需要使用到的函数的命名空间。(调用的时候NameSpace.fun()调用函数)</span>
<span class="token keyword">from</span> Namspace <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token comment">#这样也行区别在于上面导入了一个对象，这个导入了所有的函数。（加上这一句，调用的时候直接func()调用函数）</span>
<span class="token comment">#上面这些操作的简便写法如下：</span>
<span class="token keyword">import</span> clr
clr<span class="token punctuation">.</span>AddReferenceToFileAndPath<span class="token punctuation">(</span><span class="token string">r&quot;dll文件所在的地址\xxx.dll&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> xxxNamspace  <span class="token comment"># 导入这个dll文件中,我们需要使用到的函数或者类的命名空间</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4导入丰富的第三方入python模块" tabindex="-1"><a class="header-anchor" href="#_2-4导入丰富的第三方入python模块" aria-hidden="true">#</a> 2.4导入丰富的第三方入Python模块</h4><blockquote><p>1.在DynamoSandbox即Dynamo中的Python Script使用sys查看Python版本(因为使用的时候Python版本要对应上，并且此模块也要支持ICRONPYTHON，当然高版本Dynamo中用的是CPython)</p></blockquote><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 启用 Python 支持和加载 DesignScript 库</span>
<span class="token keyword">import</span> clr
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;ProtoGeometry&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>DesignScript<span class="token punctuation">.</span>Geometry <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> sys
<span class="token comment"># 该节点的输入内容将存储为 IN 变量中的一个列表。</span>
dataEnteringNode <span class="token operator">=</span> IN
<span class="token comment"># 将输出内容指定给 OUT 变量。</span>
OUT <span class="token operator">=</span> sys<span class="token punctuation">.</span>version
<span class="token comment">#Dynamo版本为2.0输出的Python版本为2.7.3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>2.安装对应的Python（略，其他章节有介绍）以及对应的包管理器Pip(略），使用Pip安装对应的包</p></blockquote><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>pip install numpy
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>3.使用sys模块将上一步安装的Python目录下的site-packages添加到路径，就可以在Dynamo里面导入这个模块了</p></blockquote><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 启用 Python 支持和加载 DesignScript 库</span>
<span class="token keyword">import</span> sys
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;ProtoGeometry&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>DesignScript<span class="token punctuation">.</span>Geometry <span class="token keyword">import</span> <span class="token operator">*</span>
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">r&#39;C:\ProgramData\Anaconda3\envs\Dynamo373\Lib\site-packages&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> numpy
zeros <span class="token operator">=</span> numpy<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
output <span class="token operator">=</span> zeros<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
OUT <span class="token operator">=</span> output
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：当然，也可以从网上下载numpy.py，随便丢个路径，再在Dynamo里面引用这个路径，就是比较麻烦，而且版本可能错误</p><h4 id="_2-5导入其他dll库-例如从网上下载的numpy-dll" tabindex="-1"><a class="header-anchor" href="#_2-5导入其他dll库-例如从网上下载的numpy-dll" aria-hidden="true">#</a> 2.5导入其他dll库(例如从网上下载的numpy.dll)</h4><p>同2.3不再介绍</p><h4 id="_2-6拓展" tabindex="-1"><a class="header-anchor" href="#_2-6拓展" aria-hidden="true">#</a> 2.6拓展</h4><blockquote><p>IcronPython的默认安装路径<code>C:\Program Files (x86)\IronPython 2.7\Lib</code>里面有很多Python库，引用里面的文件也不需要单独添加路径</p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248385774-864702f3-22ec-4bf5-b851-2f7bb34533e1.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=qzWT0&amp;originHeight=675&amp;originWidth=844&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""></p><h3 id="_3-常用dll库的相关路径-python-path里面均已添加路径" tabindex="-1"><a class="header-anchor" href="#_3-常用dll库的相关路径-python-path里面均已添加路径" aria-hidden="true">#</a> 3.常用dll库的相关路径(PYTHON PATH里面均已添加路径)</h3><blockquote><p>Dynamo封装库(使用Everything即可查看路径)</p></blockquote><p>Revit提供给Dynamo操纵Revit的库，Dynamo里面的电池后面图标有Revit的都是通过这些库实现的，我们可以通过在Python Script里面调用这个dll库，进而使用里面的函数。例如：<code>RevitNodes</code>,在Dynamo安装路径下的<code>Dynamo Revit</code>文件夹下<code>D:\software\DYNAMO2.0\Dynamo\Dynamo Revit\2\Revit_2018</code><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248385872-82f2bf35-03eb-46b0-8631-a0944e80e8a4.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=q9Ld0&amp;originHeight=312&amp;originWidth=905&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""></p><blockquote><p>Dynamo原生库</p></blockquote><p>图标没有Revit的电池都是通过这些库实现的。例如<code>ProtoGeometry.dll,DynamoCore,DynamoPackages</code>，其路径都在Dynamo安装目录下的<code>Dynamo Core</code>文件夹下： <code>D:\software\DYNAMO1.3\Dynamo\Dynamo Core\1.3</code><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248385961-9ed406f4-c204-45da-922f-d53f8be61323.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=Len5W&amp;originHeight=665&amp;originWidth=809&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""></p><blockquote><p>Revit原生库</p></blockquote><p>Revit自身功能调用的库，在Revit的安装目录下。它也可以在PythonScript里面通过CLR引用进来，其本质与通过C#进行Revit二次开发一样。例如<code>RevitAPI.dll</code>路径为：<code>D:\software\REVIT2018\Revit 2018</code><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248386094-8e5aab40-11b5-437d-97fe-240b6d49bddb.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=GsKOa&amp;originHeight=410&amp;originWidth=952&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""> 注意：以上这些路径默认已经添加，无需再通过sys.path.appebd(path)添加；可以通过LLSPY等反编译工具查看文件的命名空间以及定义的函数</p><h3 id="_4-cpython、ipython、pypy、jython、ironpython名词解释" tabindex="-1"><a class="header-anchor" href="#_4-cpython、ipython、pypy、jython、ironpython名词解释" aria-hidden="true">#</a> 4.CPython、IPython、PyPy、Jython、IronPython名词解释</h3><blockquote><p>当我们编写Python代码时，我们得到的是一个包含Python代码的以.py为扩展名的文本文件。要运行代码，就需要Python解释器去执行.py文件。由于整个Python语言从规范到解释器都是开源的，所以理论上，只要水平够高，任何人都可以编写Python解释器来执行Python代码（当然难度很大）。事实上，确实存在多种Python解释器。</p></blockquote><ul><li>CPython</li></ul><p>当我们从Python官方网站下载并安装好Python3.5后，我们就直接获得了一个官方版本的解释器：CPython。这个解释器是用C语言开发的，所以叫CPython。 在命令行下运行python就是启动CPython解释器。CPython是使用最广的Python解释器。</p><ul><li>IPython</li></ul><p>IPython是基于CPython之上的一个交互式解释器，也就是说，IPython只是在交互方式上有所增强，但是执行Python代码的功能和CPython是完全一样的。好比很多国产浏览器虽然外观不同，但内核其实都是调用了IE。 CPython用&gt;&gt;&gt;作为提示符，而IPython用In [序号]:作为提示符。</p><ul><li>PyPy</li></ul><p>PyPy是另一个Python解释器，它的目标是执行速度。PyPy采用JIT技术，对Python代码进行动态编译（注意不是解释），所以可以显著提高Python代码的执行速度。 绝大部分Python代码都可以在PyPy下运行，但是PyPy和CPython有一些是不同的，这就导致相同的Python代码在两种解释器下执行可能会有不同的结果。如果你的代码要放到PyPy下执行，就需要了解PyPy和CPython的不同点。</p><ul><li>Jython</li></ul><p>Jython是运行在Java平台上的Python解释器，可以直接把Python代码编译成Java字节码执行。</p><ul><li>IronPython</li></ul><p>IronPython和Jython类似，只不过IronPython是运行在微软.Net平台上的Python解释器，可以直接把Python代码编译成.Net的字节码。 注意：由于Dynamo2.7以下版本只支持IcronPython,而IcronPython又是基于Python2.7的，并且不再更新。因此，如果我们想在Dynamo里面使用Python3.x的模块就必须升级Dynamo2.7以上，Dynamo2.7以及以上版本支持CPython解释器。</p><h3 id="_5-dynamo-节点及revit-api的调用" tabindex="-1"><a class="header-anchor" href="#_5-dynamo-节点及revit-api的调用" aria-hidden="true">#</a> 5.Dynamo 节点及Revit Api的调用</h3><h4 id="_5-1-dynamo节点操纵元素" tabindex="-1"><a class="header-anchor" href="#_5-1-dynamo节点操纵元素" aria-hidden="true">#</a> 5.1 Dynamo节点操纵元素</h4><blockquote><p>使用Dynamo封装库即自身的节点在Python Script中操纵元素</p></blockquote><p>Dynamo中的元素都是由Revit封装得到的。先引入<code>RevitNodes.dll</code>然后在Python Script中调用<code>Revit.Elements</code>命名空间中的类来进行操作(Dynamo会自动开启事务，封装库无需关注)</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> clr
<span class="token comment"># 引用RevitNodes</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitNodes&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Revit <span class="token operator">//</span>导入RevitNodes<span class="token punctuation">.</span>dll中的Revit命名空间
<span class="token comment"># 使用 &#39;from Revit.Elements import *&#39;来引用Revit.Elements中需要的类</span>
<span class="token keyword">from</span> Revit<span class="token punctuation">.</span>Elements <span class="token keyword">import</span> CurveByPoints<span class="token punctuation">,</span> ReferencePoint <span class="token operator">//</span>再从具体的命名空间导入方法
<span class="token keyword">import</span> System
startRefPt <span class="token operator">=</span> IN<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
endRefPt <span class="token operator">=</span> IN<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
refPtArray <span class="token operator">=</span> System<span class="token punctuation">.</span>Array<span class="token punctuation">[</span>ReferencePoint<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">[</span>startRefPt<span class="token punctuation">,</span> endRefPt<span class="token punctuation">]</span><span class="token punctuation">)</span>
OUT <span class="token operator">=</span> CurveByPoints<span class="token punctuation">.</span>ByReferencePoints<span class="token punctuation">(</span>refPtArray<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：可以通过LLSPY查看命名空间和方法</p><h4 id="_5-2-revit-api操纵元素" tabindex="-1"><a class="header-anchor" href="#_5-2-revit-api操纵元素" aria-hidden="true">#</a> 5.2 Revit Api操纵元素</h4><blockquote><p>使用Revit Api中的方法操纵元素。</p></blockquote><p>如果直接使用RevitApi，那么需要在使用之前对元素进行解封。(需要注意的事，RevitAPI的很多操作是在事务中进行)</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> clr
<span class="token comment">#要先引入RevitAPI.dll</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPI&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Autodesk
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB <span class="token keyword">import</span> ReferencePointArray
<span class="token comment"># 引入事务，此处写法与C#中是不一样的</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitServices&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> RevitServices
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Persistence <span class="token keyword">import</span> DocumentManager
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Transactions <span class="token keyword">import</span> TransactionManager
<span class="token comment"># 引入 ToDSType(bool) 方法，此方法可以确定生成的元素是属于Dynamo的还是属于Revit的</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitNodes&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Revit
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">)</span>
<span class="token comment"># 把Dynamo的东西解封成RevitApi中的类</span>
<span class="token comment"># 解封封装方法无需引用</span>
startRefPt <span class="token operator">=</span> UnwrapElement<span class="token punctuation">(</span> IN<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
endRefPt <span class="token operator">=</span> UnwrapElement<span class="token punctuation">(</span> IN<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
<span class="token comment"># 事务开始</span>
doc <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentDBDocument
TransactionManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>EnsureInTransaction<span class="token punctuation">(</span>doc<span class="token punctuation">)</span>
<span class="token comment"># Make the CurveByPoints</span>
arr <span class="token operator">=</span> ReferencePointArray<span class="token punctuation">(</span><span class="token punctuation">)</span>
arr<span class="token punctuation">.</span>Append<span class="token punctuation">(</span>startRefPt<span class="token punctuation">)</span>
arr<span class="token punctuation">.</span>Append<span class="token punctuation">(</span>endRefPt<span class="token punctuation">)</span>
cbp <span class="token operator">=</span> doc<span class="token punctuation">.</span>FamilyCreate<span class="token punctuation">.</span>NewCurveByPoints<span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
<span class="token comment"># 事务结束</span>
TransactionManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>TransactionTaskDone<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 封装，并确定归属权</span>
OUT <span class="token operator">=</span> cbp<span class="token punctuation">.</span>ToDSType<span class="token punctuation">(</span>false<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-常用dll文件说明" tabindex="-1"><a class="header-anchor" href="#_6-常用dll文件说明" aria-hidden="true">#</a> 6.常用DLL文件说明</h3><blockquote><p>ProtoGeometry.dll</p></blockquote><ul><li>Dynamo的原生库，用来</li></ul><blockquote><p>RevitAPI.dll</p></blockquote><ul><li>RevitAPI.dll程序集包含了访问Revit中DB级的应用（Application）、文件（Document）、各类图元（Element）及各种参数（Parameter）的方法，也包含了IExternalDBApplication等接口。</li><li>所以在操作应用、修改文件、图元时需要引用RevitAPI.dll</li><li>提供处理Revit内基本构件Element的处理功能</li></ul><blockquote><p>RevitAPIUI.dll</p></blockquote><ul><li>RevitAPIUI.dll包含了所有操作和定制Revit UI的接口：</li><li>IExternalCommand相关接口</li><li>IExternalApplication相关接口</li><li>Selection选择（Revit内用户交互选择）</li><li>菜单类RibbonPanel、RibbonItem以及其子类</li><li>TaskDialogs任务对话框（实时输出）</li><li>IExternalEventHandler相关接口</li></ul><blockquote><p>RevitNodes.dll</p></blockquote><ul><li>提供对Dynamo内节点的支持，这样可以在Python Script里面直接写Design Script代码，否则Python Script节点内是不支持的</li></ul><blockquote><p>RevitServices.dll</p></blockquote><ul><li>提供对Revit多文档以及构件的事务处理（修改构件，更新数据库时必需的）服务</li></ul><h3 id="_7-python-script调用dynamo自带的节点库" tabindex="-1"><a class="header-anchor" href="#_7-python-script调用dynamo自带的节点库" aria-hidden="true">#</a> 7.Python Script调用Dynamo自带的节点库</h3><h4 id="_7-1dynamo节点库路径" tabindex="-1"><a class="header-anchor" href="#_7-1dynamo节点库路径" aria-hidden="true">#</a> 7.1Dynamo节点库路径</h4><ul><li>Revit2020及以上在Revit的安装目录下：<code>D:\software\Revit 2022\AddIns\DynamoForRevit\Revit</code></li><li>其他版本Dynamo可以独立安装，在其安装目录下:<code>D:\software\DYNAMO2.0\Dynamo\Dynamo Revit\2\Revit_2018</code></li></ul><h4 id="_7-2python-script调用节点" tabindex="-1"><a class="header-anchor" href="#_7-2python-script调用节点" aria-hidden="true">#</a> 7.2Python Script调用节点</h4><blockquote><p>在Python Script调用Dynamo节点函数和电池一样，注意输入的变量及类型就好，最要的是要导入dll文件和命名空间，模板中已经把所有的东西导入了，只需要照着电池写就行了</p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248386184-fee905a8-832d-4d4d-af60-e9b3451409af.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=nPLN6&amp;originHeight=663&amp;originWidth=1283&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""></p><blockquote><p>Dynamo Revit文件夹下的dll文件对应Revit库</p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248386361-1c6b2f23-e16e-42ae-aa88-7883ee08c898.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=R5mPF&amp;originHeight=136&amp;originWidth=807&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248386442-bcde7e79-b95e-4742-933d-a7bc59ec9ec4.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=IHlYn&amp;originHeight=411&amp;originWidth=365&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""></p><blockquote><p>找到.dll文件对应的.XML说明文件，可以查看其所包含的方法名称，参数及命名空间</p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248386530-0733b906-782c-43b3-903c-8716e46b3f29.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=ARQZO&amp;originHeight=672&amp;originWidth=819&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248386614-099062df-1664-4858-b8cb-761cb50f9289.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=tNZNc&amp;originHeight=405&amp;originWidth=835&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""> 注意：所有的节点均在<code>Dynamo Core与Dynamo Revit</code>文件夹下，低版本和高版本路径，略有不同，具体调用哪个方法需要引用哪个DLL自行查看.XML文件；code Block中可以直接调用方法</p><h3 id="_8-使用revitapi放置族实例" tabindex="-1"><a class="header-anchor" href="#_8-使用revitapi放置族实例" aria-hidden="true">#</a> 8.使用RevitAPI放置族实例</h3><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 启用 Python 支持和加载 DesignScript 库</span>
<span class="token keyword">import</span> clr
<span class="token comment">#ProtoGeometry是Dynamo的原生库，主要是处理几何图形的</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;ProtoGeometry&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>DesignScript<span class="token punctuation">.</span>Geometry <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token comment"># 引入C#的Revit原生模块，里面有很多函数例如创建风管墙体等等</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;RevitAPI&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token comment">#引用Dynamo封装之后的Revit模块</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;RevitNodes&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Revit
<span class="token comment">#Revit非元素与Dynamo相互转换,ToDSType()在此命名空间下</span>
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">)</span>
<span class="token comment">#Revit几何元素与Dynamo几何元素互相转换的函数在此命名空间下</span>
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>GeometryConversion<span class="token punctuation">)</span>
<span class="token comment">#引入文档与事务模块</span>
<span class="token comment">#RevitServices模块是Dynamo二次封装Revit原生模块，document和Transaction在此魔块</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;RevitServices&#39;</span><span class="token punctuation">)</span>
<span class="token comment">#from Namespace import Func [as example]直接导入指定的函数及类等</span>
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Persistence <span class="token keyword">import</span> DocumentManager
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Transactions <span class="token keyword">import</span> TransactionManager
<span class="token comment"># 将dynamo的元素转换为revit中的元素</span>
<span class="token comment">#UnwrapElement()方法不需要单独导入，可以直接使用，完成了Dynamo类型到RevitApi类型的转换，称为解封</span>
familytype <span class="token operator">=</span> UnwrapElement<span class="token punctuation">(</span>IN<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
OutPut <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment"># 获取当前文档(注意和从dynamo中获取的区别)</span>
doc <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentDBDocument
<span class="token comment"># 开启事务（注意在dynamo自带的Revit模块中，不需要这样做，其实是因为已经封装好了，也会执行事务的）</span>
TransactionManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>EnsureInTransaction<span class="token punctuation">(</span>doc<span class="token punctuation">)</span>
<span class="token comment">#Active()方法激活revit元素，只有激活之后才能使用。激活只需要一次，除非你把Revit关掉。</span>
familytype<span class="token punctuation">.</span>Activate<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 创建实例</span>
<span class="token comment">#此处XYZ()是Python的写法，c#创建一个XYZ()实例需要New一下</span>
<span class="token comment">#Revit原生方法默认为英寸，除以0.3048转化为米</span>
<span class="token comment">#Dynamo封装之后的方法例如FamilyInstance.ByPoint()默认单位是米，无需转换</span>
familyInstance <span class="token operator">=</span> doc<span class="token punctuation">.</span>Create<span class="token punctuation">.</span>NewFamilyInstance<span class="token punctuation">(</span>XYZ<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">0.3048</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">0.3048</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">0.3048</span><span class="token punctuation">)</span><span class="token punctuation">,</span> familytype<span class="token punctuation">,</span> Structure<span class="token punctuation">.</span>StructuralType<span class="token punctuation">.</span>NonStructural<span class="token punctuation">)</span>
<span class="token comment">#fam.ToDSType(Bool),False 不是revit拥有的，只受Dynamo控制,True 是revit拥有的，不受Dynamo控制</span>
<span class="token comment">#如果是Dynamo拥有的图元，再次调用不会重复创建</span>
OutPut<span class="token punctuation">.</span>append<span class="token punctuation">(</span>familyInstance<span class="token punctuation">.</span>ToDSType<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 结束事务</span>
TransactionManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>TransactionTaskDone<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 输出结果</span>
OUT <span class="token operator">=</span> OutPut
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_9-使用revitapi过滤器获取族类型族实例" tabindex="-1"><a class="header-anchor" href="#_9-使用revitapi过滤器获取族类型族实例" aria-hidden="true">#</a> 9.使用RevitApi过滤器获取族类型族实例</h3><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> clr
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;System&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic <span class="token keyword">import</span> List
<span class="token comment">#导入Dynamo中封装后的Revit节点</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitNodes&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Revit
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">)</span>
<span class="token comment"># 导入Revit原生API</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPI&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Autodesk
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token comment">#  导入Revit原生文档管理器</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitServices&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Persistence <span class="token keyword">import</span> DocumentManager
<span class="token comment">#  定义输出内容</span>
outPut<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment">#  一.获取当前文档</span>
doc <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentDBDocument
uidoc <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentUIApplication<span class="token punctuation">.</span>ActiveUIDocument
<span class="token comment">#  二、收集当前文档中所有元素</span>
collector <span class="token operator">=</span> FilteredElementCollector<span class="token punctuation">(</span>doc<span class="token punctuation">)</span>
<span class="token comment">#  三、获取某种类别下的所有元素（族实例和族类型都会获取，用得少）OST_Walls</span>
<span class="token comment">#result = FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Walls).ToElements()</span>
<span class="token comment">#  四、获取所有族，族类型，族实例</span>
<span class="token comment">#result = FilteredElementCollector(doc).OfClass(FamilyInstance).ToElements()</span>
<span class="token comment">#  五、获取某种类别下的所有族类型</span>
<span class="token comment"># FilteredElementCollector返回的值类型是C#中的LIst，无法进行索引，切片等操作。ToElements()将其转化为Python中的列表</span>
<span class="token comment">#result = FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Walls).OfClass(WallType).ToElements()</span>
<span class="token comment">#  六、进一步判断</span>
<span class="token comment">#  如果需要索引获取那么就要ToElements(),如果是循环中再操作，则不需要</span>
<span class="token comment">#因为在Dynamo中FamilySymbol.Name会报错，所以通过Get_Parameter()方法获取族类型的名称</span>
<span class="token comment">#  名字中为</span>
<span class="token comment">#for familyType in result:</span>
<span class="token comment">#  if familyType.get_Parameter(BuiltInParameter.ALL_MODEL_TYPE_NAME).AsString() == &#39;Cavity wall_sliders&#39;:</span>
<span class="token comment">#    outPut.append(familyType)</span>
<span class="token comment">#    break</span>
<span class="token comment">#  名字中包含</span>
<span class="token comment">#for familyType in result:</span>
<span class="token comment">#  if &#39;Ex&#39; in familyType.get_Parameter(BuiltInParameter.ALL_MODEL_TYPE_NAME).AsString():</span>
<span class="token comment">#    outPut.append(familyType)</span>
<span class="token comment">#  七、获取某个族实例</span>
<span class="token comment">#在dynamo中familyInstance.Name可以直接获取族实例的名字</span>
result <span class="token operator">=</span> FilteredElementCollector<span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">.</span>OfCategory<span class="token punctuation">(</span>BuiltInCategory<span class="token punctuation">.</span>OST_Walls<span class="token punctuation">)</span><span class="token punctuation">.</span>OfClass<span class="token punctuation">(</span>Wall<span class="token punctuation">)</span>
<span class="token builtin">list</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> familyInstance <span class="token keyword">in</span> result<span class="token punctuation">:</span>
  <span class="token keyword">if</span> <span class="token string">&#39;c&#39;</span> <span class="token keyword">in</span> familyInstance<span class="token punctuation">.</span>Name<span class="token punctuation">:</span>
    <span class="token builtin">list</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>familyInstance<span class="token punctuation">.</span>Id<span class="token punctuation">)</span>
<span class="token comment">#uidoc.Selection.SetElementIds(list);</span>
<span class="token comment">#由于此Revit原生方法需要的参数是C#的Icollection，因此我们将c#List模块，并按照下面套路写</span>
uidoc<span class="token punctuation">.</span>Selection<span class="token punctuation">.</span>SetElementIds<span class="token punctuation">(</span>List<span class="token punctuation">[</span>ElementId<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
OUT<span class="token operator">=</span><span class="token builtin">list</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_10-python-script中使用dynamo节点函数操纵族实例" tabindex="-1"><a class="header-anchor" href="#_10-python-script中使用dynamo节点函数操纵族实例" aria-hidden="true">#</a> 10.Python Script中使用Dynamo节点函数操纵族实例</h3><blockquote><p>放置</p></blockquote><h4 id="_10-1放置族实例" tabindex="-1"><a class="header-anchor" href="#_10-1放置族实例" aria-hidden="true">#</a> 10.1放置族实例</h4><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 加载 Python Standard 和 DesignScript 库</span>
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> clr
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;ProtoGeometry&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>DesignScript<span class="token punctuation">.</span>Geometry <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> Autodesk
<span class="token comment"># 引入Dyanmo的Revit模块</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;RevitNodes&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Revit<span class="token punctuation">.</span>Elements <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> Revit
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">)</span>
<span class="token comment"># 导入Revit原生API</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPI&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Autodesk
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token comment">#引入文档与事务模块</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;RevitServices&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Persistence <span class="token keyword">import</span> DocumentManager
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Transactions <span class="token keyword">import</span> TransactionManager
<span class="token comment"># 该节点的输入内容将存储为 IN 变量中的一个列表。</span>
dataEnteringNode <span class="token operator">=</span> IN
<span class="token comment"># 将代码放在该行下面</span>
outPut<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment">#获取当前族文档</span>
doc <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentDBDocument
<span class="token comment"># 获取族类型</span>
familyType<span class="token operator">=</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">.</span>FamilyType<span class="token punctuation">.</span>ByName<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># 获取标高</span>
levels<span class="token operator">=</span>FilteredElementCollector<span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">.</span>OfCategory<span class="token punctuation">(</span>BuiltInCategory<span class="token punctuation">.</span>OST_Levels<span class="token punctuation">)</span><span class="token punctuation">.</span>WhereElementIsNotElementType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ToElements<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> item <span class="token keyword">in</span> levels<span class="token punctuation">:</span>
  <span class="token keyword">if</span> item<span class="token punctuation">.</span>Name<span class="token operator">==</span><span class="token string">&quot;1F&quot;</span><span class="token punctuation">:</span>
    level<span class="token operator">=</span>item
familyInstance<span class="token operator">=</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">.</span>FamilyInstance<span class="token punctuation">.</span>ByPointAndLevel<span class="token punctuation">(</span>familyType<span class="token punctuation">,</span> Autodesk<span class="token punctuation">.</span>DesignScript<span class="token punctuation">.</span>Geometry<span class="token punctuation">.</span>Point<span class="token punctuation">.</span>ByCoordinates<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>level<span class="token punctuation">.</span>ToDSType<span class="token punctuation">(</span>false<span class="token punctuation">)</span><span class="token punctuation">)</span>
outPut<span class="token punctuation">.</span>append<span class="token punctuation">(</span>familyInstance<span class="token punctuation">)</span>
<span class="token comment"># 将输出内容指定给 OUT 变量。</span>
OUT <span class="token operator">=</span> level
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_10-2获取族实例属性值" tabindex="-1"><a class="header-anchor" href="#_10-2获取族实例属性值" aria-hidden="true">#</a> 10.2获取族实例属性值</h4><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 加载 Python Standard 和 DesignScript 库</span>
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> clr
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;ProtoGeometry&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>DesignScript<span class="token punctuation">.</span>Geometry <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> Autodesk
<span class="token comment"># 引入Dyanmo的Revit模块</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;RevitNodes&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Revit<span class="token punctuation">.</span>Elements <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> Revit
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">)</span>
<span class="token comment"># 导入Revit原生API</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPI&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Autodesk
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token comment">#引入文档与事务模块</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;RevitServices&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Persistence <span class="token keyword">import</span> DocumentManager
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Transactions <span class="token keyword">import</span> TransactionManager
<span class="token comment"># 该节点的输入内容将存储为 IN 变量中的一个列表。</span>
dataEnteringNode <span class="token operator">=</span> IN
<span class="token comment"># 将代码放在该行下面</span>
outPut<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment">#获取当前族文档</span>
doc <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentDBDocument
<span class="token comment"># 获取族类型</span>
familyType<span class="token operator">=</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">.</span>FamilyType<span class="token punctuation">.</span>ByName<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># 获取标高</span>
levels<span class="token operator">=</span>FilteredElementCollector<span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">.</span>OfCategory<span class="token punctuation">(</span>BuiltInCategory<span class="token punctuation">.</span>OST_Levels<span class="token punctuation">)</span><span class="token punctuation">.</span>WhereElementIsNotElementType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ToElements<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> item <span class="token keyword">in</span> levels<span class="token punctuation">:</span>
  <span class="token keyword">if</span> item<span class="token punctuation">.</span>Name<span class="token operator">==</span><span class="token string">&quot;1F&quot;</span><span class="token punctuation">:</span>
    level<span class="token operator">=</span>item
familyInstance<span class="token operator">=</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">.</span>FamilyInstance<span class="token punctuation">.</span>ByPointAndLevel<span class="token punctuation">(</span>familyType<span class="token punctuation">,</span> Autodesk<span class="token punctuation">.</span>DesignScript<span class="token punctuation">.</span>Geometry<span class="token punctuation">.</span>Point<span class="token punctuation">.</span>ByCoordinates<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>level<span class="token punctuation">.</span>ToDSType<span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
height<span class="token operator">=</span>familyInstance<span class="token punctuation">.</span>GetParameterValueByName<span class="token punctuation">(</span><span class="token string">&quot;标高中的高程&quot;</span><span class="token punctuation">)</span>
outLevel<span class="token operator">=</span>familyInstance<span class="token punctuation">.</span>GetParameterValueByName<span class="token punctuation">(</span><span class="token string">&quot;标高&quot;</span><span class="token punctuation">)</span>
outPut<span class="token punctuation">.</span>append<span class="token punctuation">(</span>familyInstance<span class="token punctuation">)</span>
<span class="token comment"># 将输出内容指定给 OUT 变量。</span>
OUT <span class="token operator">=</span> height<span class="token punctuation">,</span>outLevel
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_10-3修改族实例属性值" tabindex="-1"><a class="header-anchor" href="#_10-3修改族实例属性值" aria-hidden="true">#</a> 10.3修改族实例属性值</h4><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 加载 Python Standard 和 DesignScript 库</span>
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> clr
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;ProtoGeometry&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>DesignScript<span class="token punctuation">.</span>Geometry <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> Autodesk
<span class="token comment"># 引入Dyanmo的Revit模块</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;RevitNodes&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Revit<span class="token punctuation">.</span>Elements <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> Revit
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">)</span>
<span class="token comment"># 导入Revit原生API</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPI&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Autodesk
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token comment">#引入文档与事务模块</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;RevitServices&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Persistence <span class="token keyword">import</span> DocumentManager
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Transactions <span class="token keyword">import</span> TransactionManager
<span class="token comment"># 该节点的输入内容将存储为 IN 变量中的一个列表。</span>
dataEnteringNode <span class="token operator">=</span> IN
<span class="token comment"># 将代码放在该行下面</span>
outPut<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment">#获取当前族文档</span>
doc <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentDBDocument
<span class="token comment"># 获取族类型</span>
familyType<span class="token operator">=</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">.</span>FamilyType<span class="token punctuation">.</span>ByName<span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># 获取标高</span>
levels<span class="token operator">=</span>FilteredElementCollector<span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">.</span>OfCategory<span class="token punctuation">(</span>BuiltInCategory<span class="token punctuation">.</span>OST_Levels<span class="token punctuation">)</span><span class="token punctuation">.</span>WhereElementIsNotElementType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ToElements<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> item <span class="token keyword">in</span> levels<span class="token punctuation">:</span>
  <span class="token keyword">if</span> item<span class="token punctuation">.</span>Name<span class="token operator">==</span><span class="token string">&quot;1F&quot;</span><span class="token punctuation">:</span>
    level1<span class="token operator">=</span>item
<span class="token keyword">for</span> item <span class="token keyword">in</span> levels<span class="token punctuation">:</span>
  <span class="token keyword">if</span> item<span class="token punctuation">.</span>Name<span class="token operator">==</span><span class="token string">&quot;标高 2&quot;</span><span class="token punctuation">:</span>
    level2<span class="token operator">=</span>item
familyInstance<span class="token operator">=</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">.</span>FamilyInstance<span class="token punctuation">.</span>ByPointAndLevel<span class="token punctuation">(</span>familyType<span class="token punctuation">,</span> Autodesk<span class="token punctuation">.</span>DesignScript<span class="token punctuation">.</span>Geometry<span class="token punctuation">.</span>Point<span class="token punctuation">.</span>ByCoordinates<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>level1<span class="token punctuation">.</span>ToDSType<span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#数值赋值</span>
familyInstance<span class="token punctuation">.</span>SetParameterByName<span class="token punctuation">(</span><span class="token string">&quot;标高中的高程&quot;</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token comment">#bool/枚举赋值（0，1，2）</span>
<span class="token comment">#familyInstance.SetParameterByName(&quot;与邻近图元一同移动&quot;,1)</span>
<span class="token comment">#element赋值</span>
<span class="token comment">#familyInstance.SetParameterByName(&quot;标高&quot;,level2.ToDSType(bool))</span>
<span class="token comment">#字符串赋值</span>
familyInstance<span class="token punctuation">.</span>SetParameterByName<span class="token punctuation">(</span><span class="token string">&quot;标记&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;测试&quot;</span><span class="token punctuation">)</span>
outPut<span class="token punctuation">.</span>append<span class="token punctuation">(</span>familyInstance<span class="token punctuation">)</span>
<span class="token comment"># 将输出内容指定给 OUT 变量。</span>
OUT <span class="token operator">=</span> outPut
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1872638172@qq.com">hopesy</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.4258e646.js" defer></script>
  </body>
</html>
