import{_ as n,o as s,c as a,e as t}from"./app.4258e646.js";const p={},e=t(`<h1 id="\u5229\u7528dynamo\u590D\u5236\u6A21\u578B" tabindex="-1"><a class="header-anchor" href="#\u5229\u7528dynamo\u590D\u5236\u6A21\u578B" aria-hidden="true">#</a> \u5229\u7528Dynamo\u590D\u5236\u6A21\u578B</h1><blockquote><p>\u590D\u5236\u6A21\u578B\u9700\u8981\u7528\u5230<strong>CopyElement\uFF08\uFF09</strong></p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248981895-0069db0b-3f5e-46f2-8d8a-97d4404d2fc2.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=ATuQK&amp;originHeight=585&amp;originWidth=733&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248981989-3d11dfe3-f1bf-4287-90dc-3c044f346443.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=D2xV2&amp;originHeight=544&amp;originWidth=628&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""> \u6CE8\u610F\uFF1A\u6B64\u5904ICollection\u4E0D\u662FPython\u4E2D\u7684\u5217\u8868\uFF0C\u9700\u8981\u5BFC\u5165\u3002</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> System
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;System&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic <span class="token keyword">import</span> List <span class="token comment">#\u7528\u6CD5 b = List[ElementId](a)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u5B8C\u6574\u4EE3\u7801\u5982\u4E0B\u5C55\u793A</p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248982090-f5da0cf1-40f6-4bd3-88ee-4cec6bf1bb6e.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=ZLpuJ&amp;originHeight=787&amp;originWidth=1533&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""></p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> sys
<span class="token keyword">import</span> System
<span class="token keyword">import</span> clr
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;ProtoGeometry&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>DesignScript<span class="token punctuation">.</span>Geometry <span class="token keyword">import</span> <span class="token operator">*</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPI&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Autodesk
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB<span class="token punctuation">.</span>Events <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB <span class="token keyword">import</span> <span class="token operator">*</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitNodes&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Revit
<span class="token keyword">from</span> Revit<span class="token punctuation">.</span>Elements  <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Revit<span class="token punctuation">.</span>GeometryConversion <span class="token keyword">import</span> <span class="token operator">*</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;System&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic <span class="token keyword">import</span> List
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitServices&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> RevitServices
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Persistence <span class="token keyword">import</span> DocumentManager
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Transactions <span class="token keyword">import</span> TransactionManager
doc <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentDBDocument
<span class="token comment">#\u5C06\u5355\u4F4D\u8F6C\u6362\u4E3A\u7C73</span>
UnitType <span class="token operator">=</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB<span class="token punctuation">.</span>DisplayUnitType<span class="token punctuation">.</span>DUT_METERS
x <span class="token operator">=</span> UnitUtils<span class="token punctuation">.</span>ConvertToInternalUnits<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>IN<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>UnitType<span class="token punctuation">)</span>
y <span class="token operator">=</span> UnitUtils<span class="token punctuation">.</span>ConvertToInternalUnits<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>IN<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>UnitType<span class="token punctuation">)</span>
z <span class="token operator">=</span> UnitUtils<span class="token punctuation">.</span>ConvertToInternalUnits<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>IN<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>UnitType<span class="token punctuation">)</span>
<span class="token comment">#\u521B\u5EFA\u5411\u91CF</span>
XYZ <span class="token operator">=</span> XYZ<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span>
<span class="token comment">#\u6267\u884C\u4E8B\u52A1</span>
TransactionManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>EnsureInTransaction<span class="token punctuation">(</span>doc<span class="token punctuation">)</span>
<span class="token operator">**</span><span class="token comment">#\u5C06dynamo\u6A21\u578B\u8F6C\u6362\u4E3Arevit\u6A21\u578B\uFF08\u89E3\u5C01\uFF09</span>
Elements <span class="token operator">=</span> UnwrapElement<span class="token punctuation">(</span>IN<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> Elements<span class="token punctuation">:</span>
  a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">.</span>Id<span class="token punctuation">)</span>
b <span class="token operator">=</span> List<span class="token punctuation">[</span>ElementId<span class="token punctuation">]</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token comment">#\u590D\u5236\u6A21\u578B</span>
Ele <span class="token operator">=</span> ElementTransformUtils<span class="token punctuation">.</span>CopyElements<span class="token punctuation">(</span>doc<span class="token punctuation">,</span>b<span class="token punctuation">,</span>XYZ<span class="token punctuation">)</span><span class="token operator">**</span><span class="token operator">**</span>
<span class="token comment">#\u7ED3\u675F\u4E8B\u52A1**</span>
TransactionManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>TransactionTaskDone<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#\u8F93\u51FA\u7ED3\u679C</span>
OUT <span class="token operator">=</span> Ele
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7),o=[e];function c(i,l){return s(),a("div",null,o)}var r=n(p,[["render",c],["__file","copy.html.vue"]]);export{r as default};
