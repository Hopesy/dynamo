import{_ as n,o as s,c as a,e as t}from"./app.4258e646.js";const p={},e=t(`<h1 id="\u8FDB\u5EA6\u6761" tabindex="-1"><a class="header-anchor" href="#\u8FDB\u5EA6\u6761" aria-hidden="true">#</a> \u8FDB\u5EA6\u6761</h1><blockquote><p>\u8FDB\u5EA6\u6761,\u5B9A\u4E49\u8FDB\u5EA6\u6761\u7684\u7C7B\u5982\u4E0B\u3002\u6211\u4EEC\u53EA\u9700\u8981\u628A\u5B83\u5F15\u5165\u6211\u4EEC\u7684\u7A0B\u5E8F\u4E2D\u5B9E\u4F8B\u5316\u5373\u53EF\u3002</p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248981895-0069db0b-3f5e-46f2-8d8a-97d4404d2fc2.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=xnDVT&amp;originHeight=585&amp;originWidth=733&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""></p><blockquote><p>\u79CD\u6811\u5B9E\u4F8B</p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2022/png/12420419/1650248981989-3d11dfe3-f1bf-4287-90dc-3c044f346443.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=SN4KZ&amp;originHeight=544&amp;originWidth=628&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt=""></p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> sys
<span class="token keyword">import</span> clr
<span class="token keyword">import</span> System
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitServices&quot;</span><span class="token punctuation">)</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitNodes&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> RevitServices
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Persistence <span class="token keyword">import</span> DocumentManager
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Transactions <span class="token keyword">import</span> TransactionManager
doc <span class="token operator">=</span>  DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentDBDocument
<span class="token keyword">import</span> Revit
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">)</span>
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>GeometryConversion<span class="token punctuation">)</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPI&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB <span class="token keyword">import</span> <span class="token operator">*</span>
famType <span class="token operator">=</span> UnwrapElement<span class="token punctuation">(</span>IN<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#\u8F93\u5165FamilyType</span>
pts <span class="token operator">=</span> IN<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment">#\u8F93\u5165\u79CD\u6811\u7684\u70B9</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>pts<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  pts <span class="token operator">=</span> UnwrapElement<span class="token punctuation">(</span><span class="token punctuation">[</span>pts<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
  pts <span class="token operator">=</span> UnwrapElement<span class="token punctuation">(</span>pts<span class="token punctuation">)</span>
ProgressBarUtils <span class="token operator">=</span> IN<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
pgb <span class="token operator">=</span> ProgressBarUtils<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#\u5B9E\u4F8B\u5316\u8FDB\u5EA6\u6761\u7C7B</span>
elems <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
elemlist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment">##len(pts)\u5C31\u662F\u8FDB\u5EA6\u6761\u7684\u663E\u793A\u65F6\u95F4\uFF0C\u8FDB\u5EA6\u6761\u5B58\u5728\u7684\u65F6\u95F4\u662Fbroadcaster:\u540E\u9762\u7A0B\u5E8F\u7684\u6267\u884C\u65F6\u95F4</span>
<span class="token keyword">with</span> pgb<span class="token punctuation">.</span>MyProgressBroadcaster<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>pts<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;\u79CD\u6811\u8FDB\u5EA6&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> broadcaster<span class="token punctuation">:</span>
  TransactionManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>EnsureInTransaction<span class="token punctuation">(</span>doc<span class="token punctuation">)</span>
  <span class="token keyword">for</span> pt <span class="token keyword">in</span> pts<span class="token punctuation">:</span>
    <span class="token comment">#\u4F60\u81EA\u5DF1\u7684\u7A0B\u5E8F\u64CD\u4F5C\u903B\u8F91</span>
    <span class="token keyword">if</span> famType<span class="token punctuation">.</span>IsActive <span class="token operator">==</span> <span class="token boolean">False</span><span class="token punctuation">:</span>
      famType<span class="token punctuation">.</span>Activate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#\u5C06\u65CF\u7C7B\u578B\u6FC0\u6D3B\uFF0C\u4E0D\u8981\u6F0F\u4E86\u8FD9\u4E00\u6B65</span>
    elems <span class="token operator">=</span> doc<span class="token punctuation">.</span>Create<span class="token punctuation">.</span>NewFamilyInstance<span class="token punctuation">(</span>pt<span class="token punctuation">.</span>ToRevitType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> famType<span class="token punctuation">,</span> Structure<span class="token punctuation">.</span>StructuralType<span class="token punctuation">.</span>NonStructural<span class="token punctuation">)</span>
    <span class="token comment">#ToRevitType()\u5C06Dynamo\u7684point\u8F6C\u5316\u4E3ARevit Api\u4E2D\u7684\u70B9</span>
    elemlist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>elems<span class="token punctuation">.</span>ToDSType<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#ToDSType\u5C06\u751F\u6210\u7684elem\u6240\u6709\u6743\u7ED9Revit\uFF0C\u907F\u514D\u4E8C\u6B21\u8FD0\u884C\u6D88\u5931</span>
    <span class="token comment">#\u901A\u8FC7EventHook\u589E\u52A0\u8FDB\u5EA6\u6761</span>
    broadcaster<span class="token punctuation">.</span>onChange<span class="token punctuation">.</span>next_p<span class="token punctuation">(</span><span class="token punctuation">)</span>
  TransactionManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>TransactionTaskDone<span class="token punctuation">(</span><span class="token punctuation">)</span>
OUT <span class="token operator">=</span> elemlist
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),o=[e];function c(i,l){return s(),a("div",null,o)}var r=n(p,[["render",c],["__file","loading.html.vue"]]);export{r as default};
