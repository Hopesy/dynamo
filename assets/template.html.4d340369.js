import{_ as n,o as s,c as a,e}from"./app.4258e646.js";const t={},p=e(`<h1 id="python-script\u6A21\u677F" tabindex="-1"><a class="header-anchor" href="#python-script\u6A21\u677F" aria-hidden="true">#</a> Python Script\u6A21\u677F</h1><blockquote><p>\u6A21\u677F\u4E00\uFF08\u63A8\u8350\u4F7F\u7528\uFF09</p></blockquote><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> sys
<span class="token keyword">import</span> clr
<span class="token comment">#replace path yourself</span>
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">&#39;C:\\Program Files (x86)\\IronPython 2.7\\Lib&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> math
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;ProtoGeometry&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>DesignScript<span class="token punctuation">.</span>Geometry <span class="token keyword">import</span> <span class="token operator">*</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPI&quot;</span><span class="token punctuation">)</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPIUI&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Autodesk
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB<span class="token punctuation">.</span>Events <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>UI <span class="token keyword">import</span> <span class="token operator">*</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitNodes&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> Revit
<span class="token keyword">from</span> Revit<span class="token punctuation">.</span>Elements  <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Revit<span class="token punctuation">.</span>GeometryConversion <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> System
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;System&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic <span class="token keyword">import</span> List
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>GeometryConversion<span class="token punctuation">)</span>
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">)</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitServices&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> RevitServices
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Persistence <span class="token keyword">import</span> DocumentManager
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Transactions <span class="token keyword">import</span> TransactionManager
doc <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentDBDocument
uiapp <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentUIApplication
app <span class="token operator">=</span> uiapp<span class="token punctuation">.</span>Application
uidoc <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentUIApplication<span class="token punctuation">.</span>ActiveUIDocument
<span class="token comment">#\u6267\u884C\u4E8B\u52A1,\u89E6\u53D1\u4FEE\u6539\u4E00\u5207\u4E1C\u897F\u90FD\u8981\u5F00\u542F\u4E8B\u52A1</span>
<span class="token comment">#TransactionManager.Instance.EnsureInTransaction(doc)</span>
<span class="token comment">#\u7ED3\u675F\u4E8B\u52A1</span>
<span class="token comment">#TransactionManager.Instance.TransactionTaskDone()</span>
<span class="token comment">#\u8F93\u51FA\u7ED3\u679C</span>
<span class="token comment">#TaskDialog.Show(&quot;test&quot;, &quot;test&quot;)</span>
OUT <span class="token operator">=</span> <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u6A21\u677F\u4E8C\uFF0C\u6DFB\u52A0\u4E86\u6CE8\u91CA</p></blockquote><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># \u52A0\u8F7D Python Standard \u548C DesignScript \u5E93</span>
<span class="token keyword">import</span> sys <span class="token comment">#\u5F15\u5165Python\u6807\u51C6\u5E93,\u53EF\u4EE5\u7528\u6765\u6307\u5B9Adll\u6587\u4EF6\u7684\u8DEF\u5F84</span>
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">&#39;C:\\Program Files (x86)\\IronPython 2.7\\Lib&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> clr <span class="token comment">#\u5F15\u5165clr(Common Language Runtime)\u5E93\u3002\u5B83\u662FPython\u7A0B\u5E8F\u8FD0\u884C\u5728.net\u5E73\u53F0\u7684\u57FA\u7840\u3002</span>
<span class="token comment">#\u5982\u679C\u4E0D\u662F\u901A\u8FC7Python\u7F16\u5199\u7684\u6A21\u5757\u3002\u4F8B\u5982.NET\u5E93\uFF0C\u9700\u8981\u901A\u8FC7CLR\u6A21\u5757\u6765\u5F15\u7528\u3002\u800C\u4E14\u5C06\u8FD9\u4E2A\u6587\u4EF6\u5F15\u7528\u4E4B\u540E\uFF0C\u9700\u8981\u4ECE\u5B83\u7684\u547D\u540D\u7A7A\u95F4\u4E2D\u5BFC\u5165\u7C7B\u3002</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&#39;ProtoGeometry&#39;</span><span class="token punctuation">)</span> <span class="token comment">#\u5F15\u5165Dynamo\u81EA\u8EAB\u7684\u56FE\u5F62\u5904\u7406\u5E93</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>DesignScript<span class="token punctuation">.</span>Geometry <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token comment">#\u5F15\u5165\u5E93\u4E0B\u9762\u7684\u6240\u6709\u7C7B\u548C\u65B9\u6CD5</span>

<span class="token comment"># \u5BFC\u5165 RevitAPI \u548C RevitAPIUI</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPI&quot;</span><span class="token punctuation">)</span> <span class="token comment">#\u5BFC\u5165RevitAPI.dll\u6587\u4EF6\uFF0C\u6587\u4EF6\u540E\u7F00.dll\u53EF\u4EE5\u7701\u7565</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitAPIUI&quot;</span><span class="token punctuation">)</span> <span class="token comment">#\u5BFC\u5165RevitAPIUI.dll\u6587\u4EF6\uFF0C\u6587\u4EF6\u540E\u7F00.dll\u53EF\u4EE5\u7701\u7565</span>

<span class="token keyword">import</span> Autodesk <span class="token comment">#\u5BFC\u5165Autodesk\u547D\u540D\u7A7A\u95F4\uFF0C\u8FD9\u4E2A\u5BFC\u5165\u547D\u540D\u7A7A\u95F4\u53EF\u4EE5\u7701\u7565\uFF0C\u6700\u597D\u52A0\u4E0A\u5427</span>
<span class="token comment">#\u5982\u679C\u53EA\u5BFC\u5165namespace\u6CA1\u6709\u4E0B\u9762\u7684from * import *\u8C03\u7528\u7684\u65F6\u5019\u524D\u9762\u9700\u8981\u52A0NAmespace.func()</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>DB <span class="token keyword">import</span> <span class="token operator">*</span>  <span class="token comment">#\u518D\u4ECE\u5177\u4F53\u7684\u547D\u540D\u7A7A\u95F4\u4E0B\u5F15\u5165\u6A21\u5757\uFF0C\u8FD9\u6837\u53EF\u4EE5\u76F4\u63A5func()</span>
<span class="token keyword">from</span> Autodesk<span class="token punctuation">.</span>Revit<span class="token punctuation">.</span>UI <span class="token keyword">import</span> <span class="token operator">*</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitNodes&quot;</span><span class="token punctuation">)</span> <span class="token comment">#\u5BFC\u5165Dynamo\u5C01\u88C5\u5E93RevitNodes.dll\uFF0C\u8FD9\u6837\u53EF\u4EE5\u5728Python Script\u91CC\u9762\u76F4\u63A5\u5199Design Script\u4EE3\u7801</span>
<span class="token keyword">import</span> Revit <span class="token comment">#\u540C\u4E0AAutodesk</span>
<span class="token keyword">from</span> Revit<span class="token punctuation">.</span>Elements <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token comment">#\u5BFC\u5165\u4E4B\u540E\u5728Python Script\u8C03\u7528Dyna\u8282\u70B9\u51FD\u6570\u548C\u7535\u6C60\u4E00\u6837</span>

<span class="token comment">#\u5BFC\u5165List\u5BF9\u5E94C#\u4E2D\u7684Icollection</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;System&quot;</span><span class="token punctuation">)</span> <span class="token comment">#\u5BFC\u5165.net\u4E2D\u7684system</span>
<span class="token keyword">from</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic <span class="token keyword">import</span> List
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \u5BFC\u5165                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \u51E0\u4F55\u4F53                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \u8F6C\u6362\u65B9\u6CD5
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>GeometryConversion<span class="token punctuation">)</span>

<span class="token comment"># \u5BFC\u5165\u5143\u7D20\u8F6C\u6362</span>
clr<span class="token punctuation">.</span>ImportExtensions<span class="token punctuation">(</span>Revit<span class="token punctuation">.</span>Elements<span class="token punctuation">)</span>

<span class="token comment"># \u5BFC\u5165 DocumentManager \u548C TransactionManager</span>
clr<span class="token punctuation">.</span>AddReference<span class="token punctuation">(</span><span class="token string">&quot;RevitServices&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> RevitServices
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Persistence <span class="token keyword">import</span> DocumentManager
<span class="token keyword">from</span> RevitServices<span class="token punctuation">.</span>Transactions <span class="token keyword">import</span> TransactionManager

doc <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentDBDocument
uiapp <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentUIApplication
app <span class="token operator">=</span> uiapp<span class="token punctuation">.</span>Application
uidoc <span class="token operator">=</span> DocumentManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>CurrentUIApplication<span class="token punctuation">.</span>ActiveUIDocument
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),o=[p];function c(i,l){return s(),a("div",null,o)}var r=n(t,[["render",c],["__file","template.html.vue"]]);export{r as default};
